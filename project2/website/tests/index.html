<!DOCTYPE html>
<html>
<head>
  <title>jVectorMap demo</title>
  <link rel="stylesheet" media="all" href="../jquery-jvectormap.css"/>
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="../jquery-jvectormap.js"></script>
  <script src="../jquery-mousewheel.js"></script>

  <script src="../lib/jvectormap.js"></script>

  <script src="../lib/abstract-element.js"></script>
  <script src="../lib/abstract-canvas-element.js"></script>
  <script src="../lib/abstract-shape-element.js"></script>

  <script src="../lib/svg-element.js"></script>
  <script src="../lib/svg-group-element.js"></script>
  <script src="../lib/svg-canvas-element.js"></script>
  <script src="../lib/svg-shape-element.js"></script>
  <script src="../lib/svg-path-element.js"></script>
  <script src="../lib/svg-circle-element.js"></script>

  <script src="../lib/vml-element.js"></script>
  <script src="../lib/vml-group-element.js"></script>
  <script src="../lib/vml-canvas-element.js"></script>
  <script src="../lib/vml-shape-element.js"></script>
  <script src="../lib/vml-path-element.js"></script>
  <script src="../lib/vml-circle-element.js"></script>

  <script src="../lib/vector-canvas.js"></script>
  <script src="../lib/simple-scale.js"></script>
  <script src="../lib/numeric-scale.js"></script>
  <script src="../lib/ordinal-scale.js"></script>
  <script src="../lib/color-scale.js"></script>
  <script src="../lib/data-series.js"></script>
  <script src="../lib/proj.js"></script>
  <script src="../lib/world-map.js"></script>

  <script src="assets/jquery-jvectormap-world-mill-en.js"></script>
  <script>
	var mapwidth = 800;
	var mapheight = 600;
    jQuery.noConflict();
    jQuery(function(){
      var $ = jQuery;
      // Process JSON data using JSON.parse into an object
      var data = JSON.parse(document.getElementById('JSON').value);
      console.log(data);

      $('#focus-multiple').click(function(){
        $('#map1').vectorMap('set', 'focus', ['AU', 'JP']);
      });
      $('#focus-init').click(function(){
        $('#map1').vectorMap('set', 'focus', 1, 0, 0);
      });
			
      $('#map1').vectorMap({
        map: 'world_mill_en',
        focusOn: {
          x: 0.5,
          y: 0.5,
          scale: 2
        },
        series: {
          regions: [{
            scale: ['#C8EEFF', '#0071A4'],
            normalizeFunction: 'polynomial',
            values: data.net_oda
          }]
        }
      });
			

    })
  </script>
  
  <script>
	
	jQuery(document).ready(function($) {
	
	//get jVectorMap Object  
	var mapObject = $('#map1').vectorMap('get', 'mapObject');

	//get SVG element
	var mapbackground = $('#aidmap');
	
	//create interact
	$('#focus-single').click(function(){
		
		drawLine(39.8333,-98.583,80.75,30.55,1)
		  });
  
	function drawLine(lat1,lng1,lat2,lng2, width)
	{
		var Lpoint1=mapObject.latLngToPoint(lat1, lng1);
		
		//if(Lpoint1.x<=0){Lpoint1.x=Lpoint1.x+mapwidth;}
		//if(Lpoint1.y<=0){Lpoint1.y=Lpoint1.y+mapheight;}
		
		var Lpoint2=mapObject.latLngToPoint(lat2, lng2);
		
		//if(Lpoint2.x<=0){Lpoint2.x=Lpoint2.x+mapwidth;}
		//if(Lpoint2.y<=0){Lpoint2.y=Lpoint2.y+mapheight;}
		weightx=.9; //higher it is, the closer the weight is to the first point
		weighty=.65 //same, for y
		shifty=-100;
		weightx=weightx*Lpoint1.x+(1-weightx)*Lpoint2.x;
		weighty=weighty*Lpoint1.y+(1-weighty)*Lpoint2.y+shifty;
		var string = "M"+Lpoint1.x+","+Lpoint1.y+" ";
		string+="Q"+weightx+","+weighty+" ";
		string+=Lpoint2.x+","+Lpoint2.y;
		
		console.log(Lpoint1);
		console.log(Lpoint2);
		$(SVG('path'))
    .attr('d', string)
		.attr('class', 'connection')
		.attr('fill', 'none')
    .attr('stroke', 'red')
    .attr('stroke-width', 1)
    .appendTo(mapbackground);
	}
	
	//helper function for drawLine
	function SVG(tag)
	{
		 return document.createElementNS('http://www.w3.org/2000/svg', tag);
	}
	});
	
	
  </script>
</head>
<body>
	<div id="pagecontainer">
	<div id="mapcontainer">
  	<div id="map1" style="width: 800px; height: 600px"></div>
  </div>
  </div>
  <button id="focus-single">Focus on Australia</button>
  <button id="focus-multiple">Focus on Australia and Japan</button>
  <button id="focus-init">Return to the initial state</button>
  
  
  <textarea id="JSON">{"net_oda": {"BE": 2807.0, "FR": 12997.0, "DK": 2931.0, "DE": 14093.0, "JP": 10831.0, "FI": 1406.0, "NL": 6344.0, "PT": 708.0, "NO": 4934.0, "NZ": 424.0, "LU": 409.0, "CH": 3076.0, "GR": 425.0, "CA": 5457.0, "IT": 4326.0, "AU": 4983.0, "GB": 13832.0, "IE": 914.0, "ES": 4173.0, "US": 30924.0, "KR": 1328.0, "SE": 5603.0, "AT": 1111.0}, "ldc_aid": {"BE": 1103.0, "FR": 3823.0, "DK": 1078.0, "DE": 3894.0, "JP": 4243.0, "FI": 477.0, "NL": 1491.0, "PT": 360.0, "NO": 1462.0, "NZ": 122.0, "LU": 155.0, "CH": 801.0, "GR": 89.0, "CA": 1892.0, "IT": 1689.0, "AU": 1370.0, "GB": 5275.0, "IE": 485.0, "ES": 1176.0, "US": 10856.0, "KR": 475.0, "SE": 1960.0, "AT": 323.0}}</textarea>
</body>
</html>